# mbsyncrc - Mail setup
#
##
# Setup
# ln -s `pwd`/mbsyncrc $HOME/.mbsyncrc
##
#
# Useful resources:
# - http://pragmaticemacs.com/emacs/migrating-from-offlineimap-to-mbsync-for-mu4e/
# - https://wiki.archlinux.org/index.php/Isync
#
# To store password in plain text
# Pass ********
# To store the password in an encrypted file:
# PassCmd "gpg2 -q --for-your-eyes-only --no-tty -d ~/.email.passwd.gpg"
# I'm using lastpass to remember my password, mbsync-gmail is entry with app specific password
# PassCmd "lpass show --password mbsync-gmail"
#
# Specify IMAPStore (remote storage) and Maildirstore (local storage).
# Remote store: where to get the email
# Local store: where to store it locally
#
# Connections links remote folders to local folders and are specified,
# using patterns:
# - *     to match everything
# - !DIR  to exclude DIR
# - DIR   to match DIR
#
# Groups can group multiple channels so that every channel can be synced by running "mbsync group".

##
# Private gmail account - petterstorvik@gmail.com
##

IMAPAccount gmail
Host imap.gmail.com
User petterstorvik@gmail.com
PassCmd "lpass show --password mbsync-gmail"
AuthMechs LOGIN
SSLType IMAPS
CertificateFile /etc/ssl/certs/ca-certificates.crt

IMAPStore gmail-remote
Account gmail

MaildirStore gmail-local
Path ~/Maildir/petterstorvik@gmail.com/
Inbox ~/Maildir/petterstorvik@gmail.com/Inbox

# Helper to list all folders, run "mbsync -l gmail-all-folders"
Channel gmail-all-folders
Master :gmail-remote:
Slave :gmail-local:
Patterns *

Channel gmail-inbox
Master :gmail-remote:
Slave :gmail-local:
Patterns "INBOX"
Create Both
Expunge Both
SyncState *

Channel gmail-trash
Master :gmail-remote:"[Gmail]/Trash"
Slave :gmail-local:"Trash"
Create Both
#Expunge Both # Expunge both will cause deleted emails to dissapear from trash
SyncState *

Channel gmail-sent
Master :gmail-remote:"[Gmail]/Sent Mail"
Slave :gmail-local:"Sent"
Create Both
Expunge Both
SyncState *

Channel gmail-all
Master :gmail-remote:"[Gmail]/All Mail"
Slave :gmail-local:"All"
Create Both
Expunge Both
SyncState *

Channel gmail-starred
Master :gmail-remote:"[Gmail]/Starred"
Slave :gmail-local:"Starred"
Create Both
Expunge Both
SyncState *

Channel gmail-svartisenfestivalen
Master :gmail-remote:"Svartisenfestivalen"
Slave :gmail-local:"Svartisenfestivalen"
Create Both
Expunge Both
SyncState *

Group gmail
Channel gmail-inbox
Channel gmail-sent
Channel gmail-trash
Channel gmail-all
Channel gmail-starred
Channel gmail-svartisenfestivalen

##
# Work mail - petter.storvik@avantieng.no
##

IMAPAccount avantieng
Host outlook.office365.com
Port 993
User petter.storvik@avantieng.no
AuthMechs Login
PassCmd "lpass show --password mbsync-avantieng"
SSLType IMAPS
CertificateFile /etc/ssl/certs/ca-certificates.crt

IMAPStore avantieng-remote
Account avantieng

MaildirStore avantieng-local
Subfolders Verbatim
Path ~/Maildir/petter.storvik@avantieng.no/
Inbox ~/Maildir/petter.storvik@avantieng.no/Inbox

# Helper to list all folders, run "mbsync -l avantieng-all-folders"
Channel avantieng-all-folders
Master :avantieng-remote:
Slave :avantieng-local:
Patterns *

Channel avantieng-inbox
Master :avantieng-remote:
Slave :avantieng-local:
Patterns "INBOX"
Create Both
Expunge Both
SyncState *

Channel avantieng-trash
Master :avantieng-remote:"Slettede elementer"
Slave :avantieng-local:"Trash"
Create Both
#Expunge Both
SyncState *

Channel avantieng-sent
Master :avantieng-remote:"Sendte elementer"
Slave :avantieng-local:"Sent"
Create Both
Expunge Both
SyncState *

Channel avantieng-archive
Master :avantieng-remote:"Arkiv"
Slave :avantieng-local:"Archive"
Create Both
Expunge Both
SyncState *

Group avantieng
Channel avantieng-inbox
Channel avantieng-sent
Channel avantieng-trash
Channel avantieng-archive
